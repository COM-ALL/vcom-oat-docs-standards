{"name":"MDCO_ENROLL_BANNER_COURSE_ROSTERS_IN","ppdf:dataflowId":"3262da31-b147-49ff-b468-b8c37777dbe0","ppdf:owner":{"tenantId":"68f381e3-46da-47b9-ba57-6f322b8f0da1","userId":"7dfafdd0-ae6b-45b4-b007-c8b1b670cf02"},"ppdf:fastCopy":true,"version":"1.0","culture":"en-US","modifiedTime":"2026-02-01T21:06:12.6965648+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":true,"allowNativeQueries":true,"queriesMetadata":{"banner_202615_enrollments":{"queryId":"7f7cd0fe-4642-401d-9276-9d7efadb0826","queryName":"banner_202615_enrollments","queryGroupId":"6fb0ec4c-3a23-49f6-a015-f93458485a79"},"banner_202535_enrollments":{"queryId":"316c0108-16a2-4039-8411-f4a50a845462","queryName":"banner_202535_enrollments","queryGroupId":"6fb0ec4c-3a23-49f6-a015-f93458485a79"},"banner_202515_enrollments":{"queryId":"d1af457e-e08e-4a88-82f7-575be2e7af71","queryName":"banner_202515_enrollments","queryGroupId":"6fb0ec4c-3a23-49f6-a015-f93458485a79"},"MDCO-ENROLL-BANNER-COURSE-ROSTER":{"queryId":"da4c56e0-dde0-4dc9-99cf-92e5cde05aa2","queryName":"MDCO-ENROLL-BANNER-COURSE-ROSTER"},"banner_202615_sections":{"queryId":"93dd570b-aa9b-42ee-930b-9cf063a01476","queryName":"banner_202615_sections","queryGroupId":"7a9d4606-adc8-4f82-94dd-5de7f390e43f"},"banner_202515_sections":{"queryId":"12272139-d222-437f-95cb-d2ccddcfb820","queryName":"banner_202515_sections","queryGroupId":"7a9d4606-adc8-4f82-94dd-5de7f390e43f"},"banner_202535_sections":{"queryId":"fb3c9e0a-b2a7-404b-81b0-27061a156c78","queryName":"banner_202535_sections","queryGroupId":"7a9d4606-adc8-4f82-94dd-5de7f390e43f"},"banner-sections-202515-202615":{"queryId":"2df18e8b-289c-4775-9ec3-36df19890105","queryName":"banner-sections-202515-202615","queryGroupId":"1d523e54-b3b2-4d00-9b9e-f85870088b44"},"banner_202615_courses":{"queryId":"5bab28f2-29bb-4651-844e-75f60272a717","queryName":"banner_202615_courses","queryGroupId":"ddb13512-48bc-42ba-a75c-c75aed9c556d"},"banner_202515_courses":{"queryId":"4b807ce3-e3e1-4ec1-8f5c-66bef82cf2ea","queryName":"banner_202515_courses","queryGroupId":"ddb13512-48bc-42ba-a75c-c75aed9c556d"},"banner_202535_courses":{"queryId":"591d3187-e922-45dc-b8c8-c49e9f7ab9cc","queryName":"banner_202535_courses","queryGroupId":"ddb13512-48bc-42ba-a75c-c75aed9c556d"},"banner-courses-tobe normalized":{"queryId":"248684ea-376d-4272-945e-164b5d8a9073","queryName":"banner-courses-tobe normalized","queryGroupId":"3d9057a8-bd94-4279-97e5-abe8729205ae"},"CLEAN_CourseNames_No989":{"queryId":"b7f1ba0f-4af6-4e11-95df-2166dcaa72e5","queryName":"CLEAN_CourseNames_No989","queryGroupId":"1d523e54-b3b2-4d00-9b9e-f85870088b44"},"banner-courses-normalize-standard":{"queryId":"21f7476d-8ea1-4cc8-ab9e-1df2a283ab7e","queryName":"banner-courses-normalize-standard","queryGroupId":"3d9057a8-bd94-4279-97e5-abe8729205ae"},"banner-courses-normalize-cc shells":{"queryId":"bf000ce3-a532-445b-985f-f6d4db546540","queryName":"banner-courses-normalize-cc shells","queryGroupId":"3d9057a8-bd94-4279-97e5-abe8729205ae"},"banner-courses-normalize-meid989":{"queryId":"cfc0b3e4-76a2-4ace-a934-4dae1e8b8260","queryName":"banner-courses-normalize-meid989","queryGroupId":"3d9057a8-bd94-4279-97e5-abe8729205ae"},"banner-courses-202515-202615":{"queryId":"afd7e709-bc75-418d-b75a-faf20f86ff16","queryName":"banner-courses-202515-202615","queryGroupId":"1d523e54-b3b2-4d00-9b9e-f85870088b44"},"OAT-DATA-BANNER-CATALOG-CRN":{"queryId":"9444b77d-41ae-4a0b-9a3d-aab4680c206b","queryName":"OAT-DATA-BANNER-CATALOG-CRN","queryGroupId":"1d523e54-b3b2-4d00-9b9e-f85870088b44"},"MDCO-ENROLL-BANNER-COURSE-ROSTER_DataDestination":{"queryId":"32e1a6d0-edba-452f-b41a-49f46810b538","queryName":"MDCO-ENROLL-BANNER-COURSE-ROSTER_DataDestination"},"MDCO-ENROLL-BANNER-COURSE-ROSTER_WriteToDataDestination":{"queryId":"80f8741f-a11a-4aaf-a8a1-a59390e483e7","queryName":"MDCO-ENROLL-BANNER-COURSE-ROSTER_WriteToDataDestination"},"MDCO-ENROLL-BANNER-COURSE-ROSTER_TransformForWriteToDataDestination":{"queryId":"22d4dfaf-29f3-41e6-ab65-f337f40599f3","queryName":"MDCO-ENROLL-BANNER-COURSE-ROSTER_TransformForWriteToDataDestination"},"FastCopyStaging":{"queryId":"e90f3a0a-4226-42ca-bbbe-e1c39eee7086","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared banner_202615_enrollments = let\n  Source = SharePoint.Files(\"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev\", [ApiVersion = 15]),\n  Navigation = Source{[Name = \"20260131-143022-banner_202615_enrollments.csv\", #\"Folder Path\" = \"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev/datafiles/inbound/banner/banner-202615-processed/\"]}[Content],\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 8, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true])\nin\n  #\"Promoted headers\";\r\nshared banner_202535_enrollments = let\r\n  Source = SharePoint.Files(\"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev\", [ApiVersion = 15]),\r\n  Navigation = Source{[Name = \"20260131-143022-banner_202535_enrollments.csv\", #\"Folder Path\" = \"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev/datafiles/inbound/banner/banner-202535-processed/\"]}[Content],\r\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 8, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true])\r\nin\r\n  #\"Promoted headers\";\r\nshared banner_202515_enrollments = let\r\n  Source = SharePoint.Files(\"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev\", [ApiVersion = 15]),\r\n  #\"Filtered rows\" = Table.SelectRows(Source, each Text.Contains([Name], \"202515\")),\r\n  Navigation = #\"Filtered rows\"{[Name = \"20260131-143022-banner_202515_enrollments.csv\", #\"Folder Path\" = \"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev/datafiles/inbound/banner/banner-202515-processed/\"]}[Content],\r\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 8, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true])\r\nin\r\n  #\"Promoted headers\";\r\nshared #\"MDCO-ENROLL-BANNER-COURSE-ROSTER\" = let\r\n  Source = Table.Combine({banner_202615_enrollments, banner_202535_enrollments, banner_202515_enrollments}),\r\n  #\"Filtered rows\" = Table.SelectRows(Source, each ([role] = \"student\")),\r\n  #\"Removed columns\" = Table.RemoveColumns(#\"Filtered rows\", {\"associated_user_id\", \"limit_section_privileges\", \"role_id\"}),\r\n  #\"Reordered columns\" = Table.ReorderColumns(#\"Removed columns\", {\"user_id\", \"role\", \"status\", \"course_id\", \"section_id\"}),\r\n  #\"Merged queries\" = Table.NestedJoin(#\"Reordered columns\", {\"section_id\"}, #\"banner-sections-202515-202615\", {\"section_id\"}, \"banner-sections-202515-202615\", JoinKind.LeftOuter),\r\n  #\"Expanded banner-sections-202515-202615\" = Table.ExpandTableColumn(#\"Merged queries\", \"banner-sections-202515-202615\", {\"status\", \"ban_CRN\", \"term\", \"ban_DEPT\", \"ban_CRSNUM\", \"ban_COURSENAME\", \"ban_SECTNUM\", \"BAN_CRSCAT_KEY_important\", \"MDCO_COURSE_UID\"}, {\"status.1\", \"ban_CRN\", \"term\", \"ban_DEPT\", \"ban_CRSNUM\", \"ban_COURSENAME\", \"ban_SECTNUM\", \"BAN_CRSCAT_KEY_important\", \"MDCO_COURSE_UID\"}),\r\n  #\"Reordered columns 1\" = Table.ReorderColumns(#\"Expanded banner-sections-202515-202615\", {\"MDCO_COURSE_UID\", \"course_id\", \"section_id\", \"user_id\", \"role\", \"status\", \"status.1\", \"ban_CRN\", \"term\", \"ban_DEPT\", \"ban_CRSNUM\", \"ban_SECTNUM\", \"ban_COURSENAME\", \"BAN_CRSCAT_KEY_important\"}),\r\n  #\"Removed columns 1\" = Table.RemoveColumns(#\"Reordered columns 1\", {\"status.1\"}),\r\n  #\"Reordered columns 2\" = Table.ReorderColumns(#\"Removed columns 1\", {\"MDCO_COURSE_UID\", \"course_id\", \"section_id\", \"user_id\", \"role\", \"status\", \"term\", \"ban_CRN\", \"ban_DEPT\", \"ban_CRSNUM\", \"ban_SECTNUM\", \"ban_COURSENAME\", \"BAN_CRSCAT_KEY_important\"}),\r\n  #\"Removed columns 2\" = Table.RemoveColumns(#\"Reordered columns 2\", {\"BAN_CRSCAT_KEY_important\"})\r\nin\r\n  #\"Removed columns 2\";\r\nshared banner_202615_sections = let\n  Source = SharePoint.Files(\"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev\", [ApiVersion = 15]),\n  Navigation = Source{[Name = \"20260131-143022-banner_202615_sections.csv\", #\"Folder Path\" = \"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev/datafiles/inbound/banner/banner-202615-processed/\"]}[Content],\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 8, QuoteStyle = QuoteStyle.None]),\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true])\nin\n  #\"Promoted headers\";\r\nshared banner_202515_sections = let\n  Source = SharePoint.Files(\"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev\", [ApiVersion = 15]),\n  Navigation = Source{[Name = \"20260131-143022-banner_202515_sections.csv\", #\"Folder Path\" = \"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev/datafiles/inbound/banner/banner-202515-processed/\"]}[Content],\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 8, QuoteStyle = QuoteStyle.None]),\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true])\nin\n  #\"Promoted headers\";\r\nshared banner_202535_sections = let\n  Source = SharePoint.Files(\"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev\", [ApiVersion = 15]),\n  Navigation = Source{[Name = \"20260131-143022-banner_202535_sections.csv\", #\"Folder Path\" = \"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev/datafiles/inbound/banner/banner-202535-processed/\"]}[Content],\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 8, QuoteStyle = QuoteStyle.None]),\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true])\nin\n  #\"Promoted headers\";\r\nshared #\"banner-sections-202515-202615\" = let\r\n  Source = Table.Combine({banner_202615_sections, banner_202535_sections, banner_202515_sections}),\r\n  #\"Removed columns\" = Table.RemoveColumns(Source, {\"\", \"end_date\", \"start_date\", \"integration_id\"}),\r\n  #\"Duplicated column\" = Table.DuplicateColumn(#\"Removed columns\", \"section_id\", \"section_id - Copy\"),\r\n  #\"Split column by delimiter\" = Table.SplitColumn(#\"Duplicated column\", \"section_id - Copy\", Splitter.SplitTextByDelimiter(\".\"), {\"section_id - Copy.1\", \"section_id - Copy.2\"}),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Split column by delimiter\", {{\"section_id - Copy.1\", \"ban_CRN\"}}),\r\n  #\"Renamed columns 1\" = Table.RenameColumns(#\"Renamed columns\", {{\"name\", \"canv_sectname\"}, {\"course_id\", \"canv_courseid\"}, {\"section_id - Copy.2\", \"term\"}}),\r\n  #\"Added custom\" = Table.AddColumn(#\"Renamed columns 1\", \"canv_sectname_match\", each [canv_sectname] & [term]),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Added custom\", {{\"canv_sectname_match\", type text}}),\r\n  #\"Merged queries\" = Table.NestedJoin(#\"Changed column type\", {\"canv_sectname_match\"}, #\"banner-courses-202515-202615\", {\"canv_sectname\"}, \"banner-courses-202515-202615\", JoinKind.LeftOuter),\r\n  #\"Expanded banner-courses-202515-202615\" = Table.ExpandTableColumn(#\"Merged queries\", \"banner-courses-202515-202615\", {\"canv_long_name\", \"ban_DEPT\", \"ban_CRSNUM\", \"ban_COURSENAME\", \"ban_SECTNUM\", \"BAN_CRSCAT_KEY_important\"}, {\"canv_long_name\", \"ban_DEPT\", \"ban_CRSNUM\", \"ban_COURSENAME\", \"ban_SECTNUM\", \"BAN_CRSCAT_KEY_important\"}),\r\n  #\"Merged queries 1\" = Table.NestedJoin(#\"Expanded banner-courses-202515-202615\", {\"term\", \"ban_CRN\"}, #\"OAT-DATA-BANNER-CATALOG-CRN\", {\"BAN-TERM\", \"BAN-CRN\"}, \"OAT-DATA-BANNER-CATALOG-CRN\", JoinKind.LeftOuter),\r\n  #\"Expanded OAT-DATA-BANNER-CATALOG-CRN\" = Table.ExpandTableColumn(#\"Merged queries 1\", \"OAT-DATA-BANNER-CATALOG-CRN\", {\"MDCO_COURSE_UID\"}, {\"MDCO_COURSE_UID\"}),\r\n  #\"Removed columns 1\" = Table.RemoveColumns(#\"Expanded OAT-DATA-BANNER-CATALOG-CRN\", {\"canv_sectname_match\"})\r\nin\r\n  #\"Removed columns 1\";\r\nshared banner_202615_courses = let\n  Source = SharePoint.Files(\"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev\", [ApiVersion = 15]),\n  Navigation = Source{[Name = \"20260131-143022-banner_202615_courses.csv\", #\"Folder Path\" = \"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev/datafiles/inbound/banner/banner-202615-processed/\"]}[Content],\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 8, QuoteStyle = QuoteStyle.None]),\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true])\nin\n  #\"Promoted headers\";\r\nshared banner_202515_courses = let\n  Source = SharePoint.Files(\"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev\", [ApiVersion = 15]),\n  Navigation = Source{[Name = \"20260131-143022-banner_202515_courses.csv\", #\"Folder Path\" = \"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev/datafiles/inbound/banner/banner-202515-processed/\"]}[Content],\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 8, QuoteStyle = QuoteStyle.None]),\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true])\nin\n  #\"Promoted headers\";\r\nshared banner_202535_courses = let\n  Source = SharePoint.Files(\"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev\", [ApiVersion = 15]),\n  Navigation = Source{[Name = \"20260131-143022-banner_202535_courses.csv\", #\"Folder Path\" = \"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev/datafiles/inbound/banner/banner-202535-processed/\"]}[Content],\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 8, QuoteStyle = QuoteStyle.None]),\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true])\nin\n  #\"Promoted headers\";\r\nshared #\"banner-courses-tobe normalized\" = let\n  Source = Table.Combine({banner_202615_courses, banner_202515_courses, banner_202535_courses}),\n  #\"Removed columns\" = Table.RemoveColumns(Source, {\"integration_id\", \"account_id\"}),\n  #\"Split column by delimiter\" = Table.SplitColumn(#\"Removed columns\", \"start_date\", Splitter.SplitTextByDelimiter(\"T\"), {\"start_date.1\", \"start_date.2\"}),\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Split column by delimiter\", {{\"start_date.1\", type date}}),\n  #\"Removed columns 1\" = Table.RemoveColumns(#\"Changed column type\", {\"start_date.2\"}),\n  #\"Renamed columns\" = Table.RenameColumns(#\"Removed columns 1\", {{\"start_date.1\", \"start_date\"}}),\n  #\"Filtered rows\" = Table.SelectRows(#\"Renamed columns\", each not Text.Contains([course_id], \"DUP\"))\nin\n  #\"Filtered rows\";\r\nshared CLEAN_CourseNames_No989 = let\n  Source = Table.Combine({banner_202615_courses, banner_202515_courses, banner_202535_courses}),\n  #\"Removed columns\" = Table.RemoveColumns(Source, {\"integration_id\", \"account_id\"}),\n  #\"Split column by delimiter\" = Table.SplitColumn(#\"Removed columns\", \"start_date\", Splitter.SplitTextByDelimiter(\"T\"), {\"start_date.1\", \"start_date.2\"}),\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Split column by delimiter\", {{\"start_date.1\", type date}}),\n  #\"Removed columns 1\" = Table.RemoveColumns(#\"Changed column type\", {\"start_date.2\"}),\n  #\"Renamed columns\" = Table.RenameColumns(#\"Removed columns 1\", {{\"start_date.1\", \"start_date\"}}),\n  #\"Filtered rows\" = Table.SelectRows(#\"Renamed columns\", each not Text.Contains([course_id], \".DUP\") or not Text.Contains([course_id], \".CC\")),\n  #\"Split column by delimiter 1\" = Table.SplitColumn(#\"Filtered rows\", \"course_id\", Splitter.SplitTextByEachDelimiter({\".\"}, QuoteStyle.Csv, true), {\"course_id.1\", \"course_id.2\"}),\n  #\"Renamed columns 1\" = Table.RenameColumns(#\"Split column by delimiter 1\", {{\"course_id.1\", \"banner_crs_MD\"}}),\n  #\"Filtered rows 1\" = Table.SelectRows(#\"Renamed columns 1\", each not Text.Contains([banner_crs_MD], \"MEID.989\")),\n  #\"Split column by delimiter 3\" = Table.SplitColumn(#\"Filtered rows 1\", \"long_name\", Splitter.SplitTextByDelimiter(\":\"), {\"long_name.1\", \"long_name.2\"}),\n  #\"Renamed columns 2\" = Table.RenameColumns(#\"Split column by delimiter 3\", {{\"long_name.2\", \"CourseName\"}, {\"banner_crs_MD\", \"banner_TEMP-MDCODE\"}}),\n  #\"Removed columns 2\" = Table.RemoveColumns(#\"Renamed columns 2\", {\"course_id.2\", \"short_name\", \"long_name.1\", \"term_id\", \"status\", \"start_date\"}),\n  #\"Removed duplicates\" = Table.Distinct(#\"Removed columns 2\", {\"banner_TEMP-MDCODE\"}),\n  #\"Cleaned text\" = Table.TransformColumns(#\"Removed duplicates\", {{\"CourseName\", each Text.Clean(_), type nullable text}}),\n  #\"Trimmed text\" = Table.TransformColumns(#\"Cleaned text\", {{\"CourseName\", each Text.Trim(_), type nullable text}}),\n  #\"Replaced value\" = Table.ReplaceValue(#\"Trimmed text\", \"GYNECOLOGY & WOMENâ€™S HEALTH\", \"GYNECOLOGY & WOMENS HEALTH\", Replacer.ReplaceText, {\"CourseName\"}) //Clean offending text string in CourseName\nin\n  #\"Replaced value\";\r\nshared #\"banner-courses-normalize-standard\" = let\n  // === DATA INPUT ===\n  // Reference centrally processed and cleaned course data\n  Source = #\"banner-courses-tobe normalized\",\n  \n  // === COURSE TYPE FILTERING ===\n  // Include only standard courses (exclude special handling cases)\n  #\"Filter standard courses\" = Table.SelectRows(Source, each \n    not Text.Contains([course_id], \".CC\") and      // Exclude combined courses\n    not Text.Contains([course_id], \"989\")          // Exclude MEID.989 courses\n  ),\n  \n  // === COURSE ID PARSING ===\n  // Duplicate course_id column for parsing without losing original\n  #\"Duplicate course ID\" = Table.DuplicateColumn(\n    #\"Filter standard courses\", \n    \"course_id\", \n    \"course_id_parse\"\n  ),\n  \n  // Split course ID to separate dept.course combination from section\n  // Format: \"DEPT.CRSNUM.TERM.SECTION\" → \"DEPT.CRSNUM\" | \"TERM.SECTION\"\n  #\"Split dept.course from section\" = Table.SplitColumn(\n    #\"Duplicate course ID\", \n    \"course_id_parse\", \n    Splitter.SplitTextByEachDelimiter({\".\"}, QuoteStyle.Csv, true), \n    {\"dept_course_combo\", \"remaining_parts\"}\n  ),\n  #\"Rename for clarity\" = Table.RenameColumns(\n    #\"Split dept.course from section\", \n    {{\"dept_course_combo\", \"dept_code\"}}\n  ),\n  \n  // === COURSE NAME STANDARDIZATION ===\n  // Join with course name reference table using dept.course combination\n  // CRITICAL: Must use \"DEPT.CRSNUM\" format (e.g., \"MPED.800\") for proper lookup\n  #\"Lookup course names\" = Table.NestedJoin(\n    #\"Rename for clarity\", \n    {\"dept_code\"},                    // \"DEPT.CRSNUM\" combination\n    CLEAN_CourseNames_No989, \n    {\"banner_TEMP-MDCODE\"},           // Matches \"DEPT.CRSNUM\" format\n    \"CourseNames\", \n    JoinKind.LeftOuter\n  ),\n  #\"Expand course names\" = Table.ExpandTableColumn(\n    #\"Lookup course names\", \n    \"CourseNames\", \n    {\"CourseName\"}, \n    {\"standardized_name\"}\n  ),\n  \n  // === BANNER FIELD EXTRACTION ===\n  // Parse dept.course combination into separate Banner department and course fields\n  // Format: \"DEPT.CRSNUM\" → \"DEPT\" | \"CRSNUM\"\n  #\"Parse banner fields\" = Table.SplitColumn(\n    #\"Expand course names\", \n    \"dept_code\", \n    Splitter.SplitTextByDelimiter(\".\"), \n    {\"ban_DEPT\", \"ban_CRSNUM\", \"temp_field\"}\n  ),\n  #\"Remove temp field\" = Table.RemoveColumns(\n    #\"Parse banner fields\", \n    {\"temp_field\"}\n  ),\n  \n  // === OUTPUT FORMAT STANDARDIZATION ===\n  // Rename all columns to match required output schema\n  #\"Standardize column names\" = Table.RenameColumns(\n    #\"Remove temp field\", \n    {\n      {\"remaining_parts\", \"ban_SECTNUM\"},        // Section from remaining course_id parts\n      {\"standardized_name\", \"ban_COURSENAME\"},  // Clean course name from lookup\n      {\"start_date\", \"ban_startdate\"},          // Course start date\n      {\"status\", \"ban_status\"},                 // Course status\n      {\"long_name\", \"canv_long_name\"},          // Canvas long name\n      {\"short_name\", \"canv_short_name\"},        // Canvas short name\n      {\"term_id\", \"ban_term_id\"},               // Banner term\n      {\"course_id\", \"canv_course_id\"}           // Canvas course ID\n    }\n  ),\n  \n  // === FINAL OUTPUT ===\n  // Reorder columns to match specified output format\n  #\"Reorder columns\" = Table.ReorderColumns(\n    #\"Standardize column names\", \n    {\n      \"canv_course_id\", \"canv_short_name\", \"canv_long_name\",\n      \"ban_term_id\", \"ban_status\", \"ban_startdate\", \n      \"ban_DEPT\", \"ban_CRSNUM\", \"ban_COURSENAME\", \"ban_SECTNUM\"\n    }\n  )\n  \nin\n  #\"Reorder columns\";\r\nshared #\"banner-courses-normalize-cc shells\" = let\n  // === DATA PREPARATION ===\n  // Reference the pre-combined and cleaned data from central query\n  Source = #\"banner-courses-tobe normalized\",\n\n  // === DATA FILTERING ===\n  // Focus on combination codes (CC)\n  #\"Filtered CC courses\" = Table.SelectRows(Source, each Text.Contains([course_id], \".CC\")),\n\n  // === COURSE ID PARSING ===\n  // Extract department and course information from course_id\n  #\"Duplicated course ID\" = Table.DuplicateColumn(#\"Filtered CC courses\", \"course_id\", \"course_id_temp\"),\n  #\"Split course ID parts\" = Table.SplitColumn(#\"Duplicated course ID\", \"course_id_temp\", Splitter.SplitTextByEachDelimiter({\".\"}, QuoteStyle.Csv, true), {\"course_prefix\", \"cc_suffix\"}),\n  \n  // === COURSE NAME LOOKUP ===\n  // Join with course name reference table for clean course names\n  #\"Merged course names\" = Table.NestedJoin(#\"Split course ID parts\", {\"course_prefix\"}, CLEAN_CourseNames_No989, {\"banner_TEMP-MDCODE\"}, \"CLEAN_CourseNames_No989\", JoinKind.LeftOuter),\n  #\"Expanded course names\" = Table.ExpandTableColumn(#\"Merged course names\", \"CLEAN_CourseNames_No989\", {\"CourseName\"}, {\"CourseName\"}),\n  \n  // Parse department and course number from course prefix\n  #\"Split dept and course\" = Table.SplitColumn(#\"Expanded course names\", \"course_prefix\", Splitter.SplitTextByDelimiter(\".\"), {\"ban_DEPT\", \"ban_CRSNUM\"}),\n  \n  // Standardize column names to match output format\n  #\"Renamed columns\" = Table.RenameColumns(#\"Split dept and course\", {\n    {\"CourseName\", \"ban_COURSENAME\"}, \n    {\"start_date\", \"ban_startdate\"}, \n    {\"status\", \"ban_status\"}, \n    {\"term_id\", \"ban_term_id\"}, \n    {\"long_name\", \"canv_long_name\"}, \n    {\"short_name\", \"canv_short_name\"}, \n    {\"course_id\", \"canv_course_id\"}\n  }),\n  #\"Removed temp columns\" = Table.RemoveColumns(#\"Renamed columns\", {\"cc_suffix\"}),\n\n  // === SECTION ID EXTRACTION AND EXPANSION ===\n  // Extract section IDs from Canvas short name (format: \"DEPT-NUM:ID1,ID2,ID3\")\n  #\"Extract sections\" = Table.AddColumn(#\"Removed temp columns\", \"section_ids\", \n    each try Text.AfterDelimiter([canv_short_name], \":\") otherwise \"\"),\n  \n  // Convert comma-separated section IDs into list and expand to separate rows\n  #\"Split to list\" = Table.TransformColumns(#\"Extract sections\", {\n    {\"section_ids\", each if _ = \"\" then {} else Text.Split(_, \",\"), type {text}}\n  }),\n  #\"Expanded sections\" = Table.ExpandListColumn(#\"Split to list\", \"section_ids\"),\n  \n  // Filter out any rows with empty section IDs\n  #\"Filtered valid sections\" = Table.SelectRows(#\"Expanded sections\", each [section_ids] <> null and [section_ids] <> \"\"),\n\n  // === GENERATE FINAL FORMAT ===\n  // Create new Canvas course ID using Banner values: DEPT.CRSNUM.TERM.SECTION\n  #\"Add new course ID\" = Table.AddColumn(#\"Filtered valid sections\", \"new_course_id\", \n    each [ban_DEPT] & \".\" & [ban_CRSNUM] & \".\" & [ban_term_id] & \".\" & Text.Trim([section_ids])),\n  \n  // Create new Canvas short name: \"DEPT CRSNUM SECTION:\"\n  #\"Add new short name\" = Table.AddColumn(#\"Add new course ID\", \"new_short_name\",\n    each [ban_DEPT] & \" \" & [ban_CRSNUM] & \" \" & Text.Trim([section_ids]) & \":\"),\n  \n  // Replace original columns with new ones\n  #\"Remove old course ID\" = Table.RemoveColumns(#\"Add new short name\", {\"canv_course_id\"}),\n  #\"Remove old short name\" = Table.RemoveColumns(#\"Remove old course ID\", {\"canv_short_name\"}),\n  #\"Rename new course ID\" = Table.RenameColumns(#\"Remove old short name\", {{\"new_course_id\", \"canv_course_id\"}}),\n  #\"Rename new short name\" = Table.RenameColumns(#\"Rename new course ID\", {{\"new_short_name\", \"canv_short_name\"}}),\n  \n  // Add ban_SECTNUM column to capture section ID\n  #\"Add section number\" = Table.AddColumn(#\"Rename new short name\", \"ban_SECTNUM\", \n    each Text.Trim([section_ids])),\n  \n  // Clean up temporary columns and reorder to match expected output format\n  #\"Final cleanup\" = Table.RemoveColumns(#\"Add section number\", {\"section_ids\"}),\n  #\"Final columns\" = Table.ReorderColumns(#\"Final cleanup\", {\n    \"canv_course_id\", \"canv_short_name\", \"canv_long_name\", \n    \"ban_term_id\", \"ban_status\", \"ban_startdate\", \n    \"ban_DEPT\", \"ban_CRSNUM\", \"ban_COURSENAME\", \"ban_SECTNUM\"\n  }),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Final columns\", {{\"canv_course_id\", type text}, {\"canv_short_name\", type text}, {\"ban_SECTNUM\", type text}})\n\nin\n  #\"Changed column type\";\r\nshared #\"banner-courses-normalize-meid989\" = let\n  // === DATA INPUT ===\n  // Reference centrally processed course data\n  Source = #\"banner-courses-tobe normalized\",\n  \n  // === COURSE TYPE FILTERING ===\n  // Include only MEID.989 courses\n  #\"Filter MEID courses\" = Table.SelectRows(Source, each \n    Text.Contains([course_id], \"MEID.989\")\n  ),\n  \n  // === COURSE NAME EXTRACTION ===\n  // Parse course name from long_name field (format: \"PREFIX: COURSE NAME\")\n  #\"Duplicate long name\" = Table.DuplicateColumn(\n    #\"Filter MEID courses\", \n    \"long_name\", \n    \"long_name_parse\"\n  ),\n  #\"Extract course name\" = Table.SplitColumn(\n    #\"Duplicate long name\", \n    \"long_name_parse\", \n    Splitter.SplitTextByEachDelimiter({\":\"}, QuoteStyle.Csv), \n    {\"name_prefix\", \"course_name_raw\"}\n  ),\n  \n  // === DEPARTMENT/COURSE/SECTION PARSING ===\n  // Parse Banner fields from short_name (format: \"DEPT NUM SECT:\")\n  #\"Duplicate short name\" = Table.DuplicateColumn(\n    #\"Extract course name\", \n    \"short_name\", \n    \"short_name_parse\"\n  ),\n  #\"Split short name\" = Table.SplitColumn(\n    #\"Duplicate short name\", \n    \"short_name_parse\", \n    Splitter.SplitTextByDelimiter(\" \"), \n    {\"dept_code\", \"course_num\", \"section_part\"}\n  ),\n  #\"Extract section\" = Table.SplitColumn(\n    #\"Split short name\", \n    \"section_part\", \n    Splitter.SplitTextByDelimiter(\":\"), \n    {\"section_id\", \"colon_part\"}\n  ),\n  \n  // === DATA CLEANUP ===\n  // Remove temporary parsing columns and clean course name\n  #\"Remove temp columns\" = Table.RemoveColumns(\n    #\"Extract section\", \n    {\"colon_part\"}\n  ),\n  #\"Trim course name\" = Table.TransformColumns(\n    #\"Remove temp columns\", \n    {{\"course_name_raw\", each Text.Trim(_), type nullable text}}\n  ),\n  \n  // === OUTPUT FORMAT STANDARDIZATION ===\n  // Rename columns to match standard output schema\n  #\"Standardize canvas columns\" = Table.RenameColumns(\n    #\"Trim course name\", \n    {\n      {\"course_id\", \"canv_course_id\"},\n      {\"short_name\", \"canv_short_name\"},\n      {\"long_name\", \"canv_long_name\"},\n      {\"term_id\", \"ban_term_id\"},\n      {\"status\", \"ban_status\"},\n      {\"start_date\", \"ban_startdate\"}\n    }\n  ),\n  #\"Remove name prefix\" = Table.RemoveColumns(\n    #\"Standardize canvas columns\", \n    {\"name_prefix\"}\n  ),\n  #\"Standardize banner columns\" = Table.RenameColumns(\n    #\"Remove name prefix\", \n    {\n      {\"course_name_raw\", \"ban_COURSENAME\"},\n      {\"dept_code\", \"ban_DEPT\"},\n      {\"course_num\", \"ban_CRSNUM\"},\n      {\"section_id\", \"ban_SECTNUM\"}\n    }\n  ),\n  \n  // === FINAL OUTPUT ===\n  // Reorder columns to match specified output format\n  #\"Reorder columns\" = Table.ReorderColumns(\n    #\"Standardize banner columns\", \n    {\n      \"canv_course_id\", \"canv_short_name\", \"canv_long_name\",\n      \"ban_term_id\", \"ban_status\", \"ban_startdate\",\n      \"ban_DEPT\", \"ban_CRSNUM\", \"ban_SECTNUM\", \"ban_COURSENAME\"\n    }\n  )\n  \nin\n  #\"Reorder columns\";\r\nshared #\"banner-courses-202515-202615\" = let\n  // === FINAL DATA COMBINATION ===\n  // Combine all normalized course datasets\n  Source = Table.Combine({\n    #\"banner-courses-normalize-standard\",  // Standard courses\n    #\"banner-courses-normalize-meid989\",   // MEID.989 special courses  \n    #\"banner-courses-normalize-cc shells\"          // Combined course shells\n  }),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(Source, {{\"canv_course_id\", type text}, {\"canv_short_name\", type text}}),\r\n  #\"Added custom\" = Table.TransformColumnTypes(Table.AddColumn(#\"Changed column type\", \"canv_sectname\", each [ban_DEPT] & \"-\" & [ban_CRSNUM] & \"-\" & [ban_SECTNUM] & [ban_term_id]), {{\"canv_sectname\", type text}}),\r\n  #\"Added custom 1\" = Table.TransformColumnTypes(Table.AddColumn(#\"Added custom\", \"BAN_CRSCAT_KEY_important\", each [ban_DEPT] & \" \" & [ban_CRSNUM] & \": \" & [ban_COURSENAME]), {{\"BAN_CRSCAT_KEY_important\", type text}})\nin\n  #\"Added custom 1\";\r\nshared #\"OAT-DATA-BANNER-CATALOG-CRN\" = let\r\n  Source = Lakehouse.Contents(null),\r\n  Navigation = Source{[workspaceId = \"c9e4d5a1-d250-42a1-a864-5acd524511e1\"]}[Data],\r\n  #\"Navigation 1\" = Navigation{[lakehouseId = \"fa80ccb4-153e-4730-80c1-9fab4f3dbd4d\"]}[Data],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[Id = \"OAT-DATA-BANNER-CATALOG-CRN\", ItemKind = \"Table\"]}[Data]\r\nin\r\n  #\"Navigation 2\";\r\nshared #\"MDCO-ENROLL-BANNER-COURSE-ROSTER_DataDestination\" = let\r\n  Pattern = Lakehouse.Contents([HierarchicalNavigation = null, CreateNavigationProperties = false, EnableFolding = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"c9e4d5a1-d250-42a1-a864-5acd524511e1\"]}[Data],\r\n  Navigation_2 = Navigation_1{[lakehouseId = \"fa80ccb4-153e-4730-80c1-9fab4f3dbd4d\"]}[Data],\r\n  TableNavigation = Navigation_2{[Id = \"MDCO-ENROLL-BANNER-COURSE-ROSTER\", ItemKind = \"Table\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[MDCO_COURSE_UID = nullable Text.Type, course_id = nullable Text.Type, section_id = nullable Text.Type, user_id = nullable Text.Type, role = nullable Text.Type, status = nullable Text.Type, term = nullable Text.Type, ban_CRN = nullable Text.Type, ban_DEPT = nullable Text.Type, ban_CRSNUM = nullable Text.Type, ban_SECTNUM = nullable Text.Type, ban_COURSENAME = nullable Text.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\n[Staging = \"FastCopyStaging\"]\r\nshared #\"MDCO-ENROLL-BANNER-COURSE-ROSTER_WriteToDataDestination\" = let\r\n  #\"MDCO-ENROLL-BANNER-COURSE-ROSTER_WriteToDataDestination\" = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = #\"MDCO-ENROLL-BANNER-COURSE-ROSTER_DataDestination\"], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], #\"MDCO-ENROLL-BANNER-COURSE-ROSTER_TransformForWriteToDataDestination\"), Action.DoNothing}))\r\nin\r\n  #\"MDCO-ENROLL-BANNER-COURSE-ROSTER_WriteToDataDestination\";\r\nshared #\"MDCO-ENROLL-BANNER-COURSE-ROSTER_TransformForWriteToDataDestination\" = let\r\n    SourceTable = Table.SelectColumns(#\"MDCO-ENROLL-BANNER-COURSE-ROSTER\", {\"MDCO_COURSE_UID\", \"course_id\", \"section_id\", \"user_id\", \"role\", \"status\", \"term\", \"ban_CRN\", \"ban_DEPT\", \"ban_CRSNUM\", \"ban_SECTNUM\", \"ban_COURSENAME\"})\r\nin\r\n    SourceTable;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://tamucs.sharepoint.com/teams/Team-vcom-oat-vdata-dev\"}","audience":null},{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}],"trustedConnections":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null}]},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"Id\":\"6fb0ec4c-3a23-49f6-a015-f93458485a79\",\"Name\":\"enrollment\",\"Description\":\"\",\"ParentId\":null,\"Order\":0},{\"Id\":\"7a9d4606-adc8-4f82-94dd-5de7f390e43f\",\"Name\":\"sections\",\"Description\":\"\",\"ParentId\":null,\"Order\":1},{\"Id\":\"ddb13512-48bc-42ba-a75c-c75aed9c556d\",\"Name\":\"courses\",\"Description\":\"\",\"ParentId\":null,\"Order\":2},{\"Id\":\"3d9057a8-bd94-4279-97e5-abe8729205ae\",\"Name\":\"courses_normalized\",\"Description\":\"\",\"ParentId\":null,\"Order\":3},{\"Id\":\"1d523e54-b3b2-4d00-9b9e-f85870088b44\",\"Name\":\"support\",\"Description\":\"\",\"ParentId\":null,\"Order\":4}]"}]}